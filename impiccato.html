<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Impiccato con Numeri</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  font-family: system-ui, sans-serif;
}

body{
  background:#f3f4f6;
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.game-container{
  max-width:600px;
  width:100%;
  margin:16px;
  padding:20px;
  background:white;
  border-radius:16px;
  box-shadow:0 8px 24px rgba(0,0,0,0.12);
  display:flex;
  flex-direction:column;
  gap:12px;
}

h1{
  margin:0;
  text-align:center;
  font-size:1.4rem;
}

.subtitle{
  text-align:center;
  color:#6b7280;
  font-size:.85rem;
}

/* --- DISPLAY PAROLA --- */
.word-display{
  font-size:1.7rem;
  letter-spacing:0.2em;
  text-align:center;
  min-height:2.4em;
  background:#f9fafb;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding:12px 10px;
  white-space:pre-wrap;
}

/* --- STATUS --- */
.status{
  display:flex;
  justify-content:space-between;
  font-size:.9rem;
  flex-wrap:wrap;
}

.attempts span{
  font-weight:800;
}

/* --- TASTIERA --- */
.keyboard{
  display:grid;
  grid-template-columns: repeat(9,1fr);
  gap:5px;
}

@media(max-width:480px){
  .keyboard{
    grid-template-columns:repeat(7,1fr);
  }
}

.key-btn{
  border:1px solid #e5e7eb;
  background:#f9fafb;
  border-radius:8px;
  padding:7px 0;
  font-weight:700;
  cursor:pointer;
}

.key-btn:hover:not(:disabled){
  background:#eef2ff;
}

.key-btn:active:not(:disabled){
  transform:translateY(1px);
}

.key-btn:disabled{
  opacity:0.6;
  cursor:default;
}

.key-correct{
  background:#dcfce7!important;
  border-color:#22c55e!important;
}

.key-wrong{
  background:#fee2e2!important;
  border-color:#ef4444!important;
}

/* --- FOOTER --- */
.bottom{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:.85rem;
  gap:8px;
  flex-wrap:wrap;
}

.used{
  flex:1;
  color:#6b7280;
}

.reset{
  background:#4f46e5;
  border:none;
  border-radius:999px;
  padding:6px 12px;
  color:white;
  font-weight:700;
  cursor:pointer;
}

.reset:hover{
  background:#4338ca;
}

/* --- RISULTATO --- */
.message{
  text-align:center;
  font-weight:800;
  min-height:1.3em;
}
.win{
  color:#16a34a;
}
.lose{
  color:#dc2626;
}

</style>
</head>
<body>

<div class="game-container">
  <h1>IMPIC CATO (con numeri)</h1>
  <div class="subtitle">
    Indovina lettere e numeri da tastiera o touch
  </div>

  <div class="status">
     <div class="attempts">Tentativi rimasti: <span id="attempts"></span></div>
     <div id="emojiStage">ğŸ™‚</div>
  </div>

  <div id="word" class="word-display"></div>

  <div class="keyboard" id="keyboard"></div>

  <div class="bottom">
     <div id="used" class="used"></div>
     <button id="reset" class="reset">Nuova parola</button>
  </div>

  <div id="message" class="message"></div>
</div>

<script>

/* ============================
    CONFIGURAZIONE
===============================*/

const WORDS = [
  "incontriamoci alla gioielleria il 30/11 alle 22:00, firmato A.N.",
];

const MAX_ATTEMPTS = 7;
const ALLOWED = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

/* ============================
    VARIABILI
===============================*/

let secret="";
let visible=[];
let attempts=MAX_ATTEMPTS;
let used=new Set();
let ended=false;

/* ============================
    DOM
===============================*/

const attemptsEl = document.getElementById("attempts");
const wordEl = document.getElementById("word");
const keyboard = document.getElementById("keyboard");
const usedEl = document.getElementById("used");
const resetBtn = document.getElementById("reset");
const message = document.getElementById("message");
const emoji = document.getElementById("emojiStage");

/* ============================
    TASTIERA
===============================*/

function buildKeyboard(){
  keyboard.innerHTML="";
  for(const c of ALLOWED){
    const b=document.createElement("button");
    b.className="key-btn";
    b.textContent=c;
    b.onclick=()=>guess(c);
    keyboard.appendChild(b);
  }
}

function markKey(c, ok){
  const k=[...keyboard.children].find(b=>b.textContent===c);
  if(!k) return;
  k.disabled=true;
  k.classList.add(ok?"key-correct":"key-wrong");
}

/* ============================
    AVVIO PARTITA
===============================*/

function newGame(){
  secret = WORDS[Math.floor(Math.random()*WORDS.length)].toUpperCase();
  visible=[];
  for(const c of secret){
    if(c===" ") visible.push(" ");
    else if(/[A-Z0-9]/.test(c)) visible.push("_");
    else visible.push(c);
  }

  attempts=MAX_ATTEMPTS;
  used.clear();
  ended=false;

  buildKeyboard();
  updateAll();

  message.textContent="";
  message.className="message";
}

/* ============================
    UI
===============================*/

function updateAll(){
  wordEl.textContent =
    visible
      .map(c=> c===" " ? "        " : c)
      .join(" ");

  attemptsEl.textContent=attempts;

  usedEl.textContent="Usati: " + (used.size ? [...used].join(" ") : "â€”");

  emoji.textContent = ["ğŸ’€","ğŸ˜¨","ğŸ˜Ÿ","ğŸ˜","ğŸ™‚","ğŸ˜„","ğŸ˜"][attempts-1];
}

/* ============================
    LOGICA
===============================*/

function guess(c){

  if(ended || used.has(c)) return;

  used.add(c);
  let ok=false;

  for(let i=0;i<secret.length;i++){
    if(secret[i]===c){
      visible[i]=c;
      ok=true;
    }
  }

  if(!ok) attempts--;

  markKey(c, ok);
  updateAll();

  if(!visible.includes("_")){
    ended=true;
    message.textContent="HAI VINTO! ğŸ‰";
    message.classList.add("win");
  }
  else if(attempts<=0){
    ended=true;
    visible=[...secret];
    updateAll();
    message.textContent="PERSO ğŸ˜­ â€” Era: "+secret;
    message.classList.add("lose");
  }
}

/* ============================
    INPUT FISICO
===============================*/

window.addEventListener("keydown", e=>{
  const k=e.key.toUpperCase();
  if(ALLOWED.includes(k)){
    'preventDefault' in e && e.preventDefault();
    guess(k);
  }
});

resetBtn.onclick=newGame;

/* ============================
    START
===============================*/

buildKeyboard();
newGame();

</script>

</body>
</html>
